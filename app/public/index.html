<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>üå§ Weather Woof üê∂</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- <link rel="stylesheet" href="assets/css/reset.css" type="text/css" /> -->
    <link rel="stylesheet" href="static/assets/css/main.css" type="text/css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body>
    <h2>
        Weather Woof
    </h2>

    <div class="row">
        <form class="col s12">
            <div class="row">
                <div class="input-field zipCode col s12">
                    <input placeholder="Enter your ZIP code" type="text" class="validate" id="zipCode">
                    <!-- <label for="zip">ZIP code</label> -->
                </div>
        </form>
    </div>

    <div class="input-field breedList col s12">
        <select id="breedDropdown" multiple>
            <option value="" disabled selected>Breed</option>
        </select>
        <!-- <label>Breed</label> -->
    </div>

    <div class="input-field col s12">
        <select id="furColor">
            <option value="" disabled selected>Fur Color</option>
            <option value="1">Tan</option>
            <option value="2">Black</option>
            <option value="3">White</option>
            <option value="4">Grey</option>
            <option value="5">Multi - Mostly Light Colored</option>
            <option value="6">Multi - Mostly Dark Colored</option>
        </select>
        <!-- <label>Health</label> -->
    </div>

    <div class="input-field col s12">
        <select id="health">
            <option value="" disabled selected>Dog's Overall Health</option>
            <option value="1">Excellent</option>
            <option value="2">Good</option>
            <option value="3">Average</option>
            <option value="4">Poor</option>
            <option value="5">Very Poor</option>
        </select>
        <!-- <label>Fur Color</label> -->
    </div>

    <div class="input-field col s12">
        <select id="age">
            <option value="" disabled selected>Age</option>
            <option value="0">Under 1</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="Unknown">Unknown</option>
        </select>
        <!-- <label>Age</label> -->
    </div>

    <div class="input-field col s12">
        <input placeholder="Enter your dog's weight" type="text" class="validate" id="weight">
        <!-- <label for="weight">Weight</label> -->
    </div>

    <div class="input-field col s12">
        <select id="weightQuestion">
            <option value="" disabled selected>Is Your Dog Considered Overweight?</option>
            <option value="1">Yes</option>
            <option value="2">No</option>
        </select>
        <!-- <label>Fur Color</label> -->
    </div>

    <button data-target="results" class="btn waves-effect waves-light modal-trigger" type="submit" name="action" id="submit">Submit
        <i class="material-icons right">send</i>
    </button>

    <!-- Modal Trigger -->
  <a class="waves-effect waves-light btn modal-trigger" href="#results"></a>

  <!-- Modal Structure -->
  <div id="results" class="modal">
    <div class="modal-content">
      <h4 id="reason-title">Should I Walk My Dog?</h4>
      <p id="reason-explanation"></p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
  </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="static/assets/materialize/materialize.min.js"></script> -->
    <script type="text/javascript" src="static/dogapi.js"></script>
    <!-- <script type="text/javascript" src="static/dogstested.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script type="text/javascript" src="static/weatherapi.js"></script>



    <script>
        $(document).ready(function () {

            //for materialize form
            $('select').formSelect();

            $('.modal').modal();

            if ($(".input-field").hasClass("breedList")) {
                    getBreedList();
                }

            $("#submit").on("click", function (event) {
                event.preventDefault();
                var weight = $('#weight').val();
                var healthSelection = $('#health')[0];
                var health = healthSelection.options[healthSelection.selectedIndex].text;
                var specificBreed = $('#breedDropdown').val();
                var weightSelectionQuestion = $("#weightQuestion")[0];
                var weightQuestion = weightSelectionQuestion.options[weightSelectionQuestion.selectedIndex].text;
                var colorSelection = $("#furColor")[0];
                var furColor = colorSelection.options[colorSelection.selectedIndex].text;
                var ageSelection = $("#age")[0];
                var age = ageSelection.options[ageSelection.selectedIndex].text;
                var key = '7f7b945e91014239992145942191307';
                var zip = $("#zipCode").val();
                
                var weatherFunction = getWeather(zip);
                console.log(weatherFunction.feelsLike)

                var formData = {
                    weight: weight,
                    health: health,
                    specifiedBreed: specificBreed,
                    weightQuestion: weightQuestion,
                    furColor: furColor,
                    age: age,
                    zip: zip,
                    feelsLike: weatherFunction.feelsLike,
                    condition: weatherFunction.condition,
                    points: 0
                // weight: $('#weight').val(),
                // health: healthSelection.options[healthSelection.selectedIndex].text,
                // specificBreed: $('#breedDropdown').val(),
                // colorSelection: $("#furColor")[0],
                // weightQuestion: weightSelectionQuestion.options[weightSelectionQuestion.selectedIndex].text,
                // ageSelection: $("#age")[0],
                // zip: $("#zipCode").val()
                };

                console.log(formData);

                var currentURL = window.location.origin;

                $.post(currentURL + "/api/dogstested", formData, function (data) {
                    $("#reason-explanation").text(data.shouldntwalk);
                })
        });
            });

    </script>

</body>

</html>